{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin Dashboard</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"
      rel="stylesheet"
    />

    <style>
      body {
        font-family: "Poppins", sans-serif;
        min-height: 100vh;
        margin: 0;
        overflow-x: hidden;
      }
      body::before {
        content: "";
        position: fixed;
        inset: 0;
        /* background: url("/static/adminui/logo1.png") no-repeat center center/cover; */
        filter: blur(7px);
        opacity: 0.5;
        z-index: -1;
      }

      /* Sidebar Fixed */
      .sidebar {
        background: #fff;
        border-radius: 12px;
        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        padding: 20px;
        width: 280px;
        height: 100vh;
        position: fixed;
        top: 0;
        left: 0;
        overflow-y: auto;
      }
      .sidebar a {
        display: block;
        padding: 8px 12px;
        color: #000;
        text-decoration: none;
        border-radius: 6px;
      }
      .sidebar a:hover,
      .sidebar .active {
        background: #e9f0ff;
        color: #0d6efd;
      }

      /* Main Content */
      .content-box {
        background: #fff;
        border-radius: 12px;
        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        padding: 20px;
        min-height: 100vh;
        margin-left: 300px; /* Push content right */
        display: flex;
        flex-direction: column;
      }

      /* Stat cards */
      .stat-card {
        border-radius: 12px;
        padding: 20px;
        color: black;
        font-weight: bold;
        background: linear-gradient(135deg, #cfc8c8, #f9f9f9);
      }
      .stat-card i {
        font-size: 2rem;
        margin-bottom: 10px;
      }

      /* Scrollable Table */
      .table-container {
        flex-grow: 1;
        overflow-y: auto;
        max-height: 60vh; /* Adjust height */
      }
      .table thead th {
        position: sticky;
        top: 0;
        background: #f8f9fa;
        z-index: 2;
      }
    </style>
  </head>
  <body>
    <!-- Sidebar -->
    <div class="sidebar d-flex flex-column">
      <div class="text-center mb-4">
        <img
          src="/static/adminui/logo1.png"
          alt="Logo"
          class="img-fluid mb-2"
          style="max-width: 80px"
        />
        <h5>Administration</h5>
      </div>
      <nav class="flex-grow-1 d-flex flex-column">
        <h6 style="color: #0d6efd">Admin</h6>
        <a href="{% url 'dashboard' %}">Dashboard</a>
        <a href="{% url 'faculty_list' %}">Faculty</a>
        <a href="{% url 'problem_upload' %}">Add Problem</a>
        <h6 style="color: #0d6efd">Student</h6>
        <a href="{% url 'student_list' %}">Change Password</a>

        <!-- Push logout to bottom -->
        <a href="{% url 'logout' %}" class="text-danger mt-auto">Logout</a>
      </nav>
    </div>

    <!-- Main Content -->
    <div class="content-box">
      <!-- Welcome -->
      <div class="alert alert-info text-center">
        <b>Welcome!! {{ request.user.username }}</b>
      </div>

      <!-- Stats Section -->
      <div class="row g-4 mb-4">
        <div class="col-md-4">
          <div class="stat-card text-center">
            <i class="bi bi-mortarboard"></i>
            <h4>{{ student_count }}</h4>
            <p>Students</p>
          </div>
        </div>
        <div class="col-md-4">
          <div class="stat-card text-center">
            <i class="bi bi-person-badge"></i>
            <h4>{{ faculty_count }}</h4>
            <p>Faculty</p>
          </div>
        </div>
        <div class="col-md-4">
          <div class="stat-card text-center">
            <i class="bi bi-journal-code"></i>
            <h4>{{ problem_count }}</h4>
            <p>Problems</p>
          </div>
        </div>
      </div>

      <!-- Submissions Table -->
      <div class="table-container">
        <div class="table-responsive">
          <table class="table table-striped table-bordered text-center">
            <thead>
              <tr>
                <th scope="col">S.No</th>
                <th scope="col">Student Name</th>
                <th scope="col">Student ID</th>
                <th scope="col">Submission Date</th>
                <th scope="col">Faculty Name</th>
                <th scope="col">Mark</th>
              </tr>
            </thead>
            <tbody>
              {% for submission in page_obj %}
              <tr>
                <th scope="row">{{ forloop.counter }}</th>
                <td>{{ submission.student.full_name }}</td>
                <td>{{ submission.student.student_id }}</td>
                <td>{{ submission.submitted_at|date:"Y-m-d H:i" }}</td>
                <td>
                  {% if submission.faculty_name %}
                    {{ submission.faculty_name }}
                  {% else %}
                    Not Evaluated
                  {% endif %}
                </td>
                <td>
                  {% if submission.faculty_marks %}
                    {{ submission.faculty_marks }}
                  {% else %}
                    -
                  {% endif %}
                </td>
              </tr>
              {% empty %}
              <tr>
                <td colspan="6" class="text-center">No submissions yet</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>

      <!-- Pagination Controls -->
  
<div class="d-flex justify-content-center mt-4">
  <nav>
    <ul class="pagination pagination-lg">
      {% if page_obj.has_previous %}
        <li class="page-item">
          <a class="page-link rounded-circle shadow-sm" href="?page={{ page_obj.previous_page_number }}">
            &laquo;
          </a>
        </li>
      {% endif %}

      {% for num in page_obj.paginator.page_range %}
        {% if page_obj.number == num %}
          <li class="page-item active">
            <span class="page-link rounded-circle shadow-sm bg-primary border-0 text-white">{{ num }}</span>
          </li>
        {% else %}
          <li class="page-item">
            <a class="page-link rounded-circle shadow-sm border-0" href="?page={{ num }}">{{ num }}</a>
          </li>
        {% endif %}
      {% endfor %}

      {% if page_obj.has_next %}
        <li class="page-item">
          <a class="page-link rounded-circle shadow-sm" href="?page={{ page_obj.next_page_number }}">
            &raquo;
          </a>
        </li>
      {% endif %}
    </ul>
  </nav>
</div>

<style>
  .pagination .page-link {
    margin: 0 5px;
    width: 45px;
    height: 45px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 600;
    transition: all 0.3s ease;
  }
  .pagination .page-link:hover {
    background-color: #a3a7aaff;
    color: #fff;
    transform: translateY(-2px);
    box-shadow: 0 4px 10px rgba(13,110,253,0.3);
  }
  .pagination .active .page-link {
    background: linear-gradient(135deg, #0d6efd, #6610f2);
    color: #fff !important;
    box-shadow: 0 4px 15px rgba(13,110,253,0.4);
  }
</style>


</html>
